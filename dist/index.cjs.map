{"version":3,"file":"index.cjs","sources":["../src/indexes/Indexes.ts","../src/shared/generateTypos.ts","../src/shared/levenshteinDistance.ts","../src/search/Search.ts","../src/shared/generateCharArray.ts","../src/FirestoreSearchEngine.ts"],"sourcesContent":[null,null,null,null,null,null],"names":["Indexes","constructor","firestoreInstance","config","props","this","execute","typos","input","maxLength","length","Error","Set","segmentSizes","keyboardNeighbors","a","z","e","r","t","y","u","i","o","p","q","s","d","f","g","h","j","k","l","m","size","start","segment","slice","firstLetter","forEach","neighbor","typo","add","trim","_a","lastLetter","_b","fse_generateTypos","inputField","wordMaxLength","saveWithLimitedKeywords","returnedFields","Array","from","keywords","bulk","bulkWriter","cleanOldIndexes","keywordChunks","push","create","collection","doc","search_keywords","flush","close","indexedDocumentPath","query","where","get","empty","docs","delete","ref","fse_levenshteinDistance","b","matrix","_","fill","cost","Math","min","Search","limit","search","fieldValue","searchKeywords","startIndex","fragments","split","word","substring","toLowerCase","console","log","fse_generateCharArray","querySnapshot","uniqueDocs","results","data","rest","uniqueId","keyword","words","isCloseEnough","closeRelevance","distanceTotal","distance","Infinity","has","relevance","sort","map","result","settings","ignoreUndefinedProperties","indexes","expressWrapper","app","path","startsWith","async","request","response","searchValue","params","json","onRequestWrapper","req","res"],"mappings":"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"}